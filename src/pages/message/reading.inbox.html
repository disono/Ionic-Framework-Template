<!--
* @author Archie, Disono (webmonsph@gmail.com)
* @url https://github.com/disono/Ionic-Framework-Template
* @copyright Webmons Development Studio. (webmons.com), 2016-2017
* @license Apache, 2.0 https://github.com/disono/Ionic-Framework-Template/blob/master/LICENSE
-->

<ion-header>
  <ion-navbar>
    <ion-title>
      Reading Message
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-list>
    <ion-item *ngFor="let data_fetch of data_list" text-wrap>
      <!-- avatar and name (you) -->
      <ion-avatar item-left *ngIf="data_fetch.sender_type == 'you'">
        <img src="{{data_fetch.from_avatar}}" />
      </ion-avatar>
      <h2 *ngIf="data_fetch.sender_type == 'you'">{{data_fetch.from_full_name}}</h2>

      <!-- avatar and name (sender) -->
      <ion-avatar item-right *ngIf="data_fetch.sender_type == 'sender'">
        <img src="{{data_fetch.from_avatar}}" />
      </ion-avatar>
      <h2 *ngIf="data_fetch.sender_type == 'sender'" style="text-align: right !important;">
        {{data_fetch.from_full_name}}</h2>

      <!-- date and time -->
      <p *ngIf="data_fetch.sender_type == 'you'">{{data_fetch.formatted_created_at}}</p>
      <p *ngIf="data_fetch.sender_type == 'sender'" style="text-align: right !important;">
        {{data_fetch.formatted_created_at}}</p>

      <!-- text message -->
      <p *ngIf="data_fetch.type == 'text' && data_fetch.sender_type == 'you'" class="text-wrap">
        {{data_fetch.message}}</p>
      <p *ngIf="data_fetch.type == 'text' && data_fetch.sender_type == 'sender'" style="text-align: right !important;">
        {{data_fetch.message}}</p>

      <!-- image message -->
      <p *ngIf="data_fetch.type == 'image' && data_fetch.sender_type == 'you'">
        <img src="{{data_fetch.file}}"
                    width="50%" />
      </p>
      <p *ngIf="data_fetch.type == 'image' && data_fetch.sender_type == 'sender'" style="text-align: right !important;">
        <img src="{{data_fetch.file}}" width="75%" />
      </p>

      <!-- video message -->
      <p *ngIf="data_fetch.type == 'video' && data_fetch.sender_type == 'you'">
        <video width="100%" controls>
          <source src="{{data_fetch.file}}" type="video/mp4">
        </video>
      </p>
      <p *ngIf="data_fetch.type == 'video' && data_fetch.sender_type == 'sender'" style="text-align: right !important;">
        <video width="100%" controls>
          <source src="{{data_fetch.file}}" type="video/mp4">
        </video>
      </p>
    </ion-item>
  </ion-list>
</ion-content>

<ion-footer>
  <!-- file -->
  <input type="file" style="display: none;" id="messageFile"
         accept="image/x-png,image/gif,image/jpeg,video/mp4,video/x-m4v">

  <ion-toolbar>
    <!-- input box -->
    <ion-input type="text" value="" [(ngModel)]="chatBox" placeholder="Type your message"></ion-input>

    <ion-buttons end>
      <!-- upload image / video -->
      <button ion-button clear (click)="openFileDialog()">
        <ion-icon ios="ios-cloud-upload" md="md-cloud-upload"></ion-icon>
      </button>

      <!-- send text message -->
      <button ion-button clear icon-right (click)="sendText(chatBox)">
        Send
        <ion-icon name="send"></ion-icon>
      </button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>
