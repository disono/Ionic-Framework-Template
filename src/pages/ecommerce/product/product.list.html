<!--
 - @author Archie Disono
 - @url https://github.com/disono/Ionic-Framework-Template
 - @license Apache 2.0
-->

<ion-header>
  <ion-navbar>
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>

    <ion-title>
      Items
    </ion-title>

    <ion-buttons end>
      <button ion-button icon-only (click)="searchProducts()">
        <ion-icon name="search"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content class="bg-product-list">
  <ion-refresher *ngIf="!init_loading" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div *ngIf="!init_loading">
    <ion-grid>
      <ion-row *ngFor="let data_fetch of data_list">
        <ion-col width-50 *ngFor="let item of data_fetch">
          <ion-card>
            <!-- item image -->
            <img [src]="item.cover" (click)="showProduct(item.id)">

            <ion-card-content>
              <!-- item name -->
              <h4 (click)="showProduct(item.id)">
                {{stringLimit(item.name)}}
              </h4>

              <!-- srp and discounted srp -->
              <p [innerHTML]="item.formatted_srp" color="danger"></p>
              <p *ngIf="item.srp_discounted" [innerHTML]="item.formatted_srp_discounted"
                 style="text-decoration: line-through;"></p>

              <!-- add to cart button -->
              <button (click)="addToCart(item.id)" ion-button block clear>Add to cart</button>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <h1 class="text-center" *ngIf="!data_list.length && !init_loading">
    No Items Found.
  </h1>

  <ion-infinite-scroll *ngIf="!init_loading" (ionInfinite)="doInfinite($event)">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>

  <h1 class="text-center" *ngIf="init_loading">
    <ion-spinner icon="spiral"></ion-spinner>
    Loading...
  </h1>
</ion-content>
